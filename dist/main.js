(()=>{"use strict";var t,e={6:(t,e,o)=>{var r=o(325);const n=o.p+"9b8606ea9f0f4b78b4cd7ce817564074.png",i=o.p+"bd99eb41ea5cc3d44e26b5d2809fce41.png",s=o.p+"cf46998813a16deda5b1df84e8ba4a58.png",a=o.p+"5f7dc58022982b36f3e7f336df2e1fe3.png",c=o.p+"61977b58651acbc9a3245a94f185238b.png",l=o.p+"8934b41ac754a9dbdf0fdfffa1807d52.wav",p=o.p+"d292f5f80075fd4216d6da8d459f64c5.wav",u=o.p+"81bc95ba9d9e1dca2626111d8282fc01.wav",h=o.p+"0237cbdaf14a8ac95dd35a9934987b23.png";var f={bot:new r.Texture(n),botRed:new r.Texture(i),baddie:new r.Texture(s),block:new r.Texture(a),npc:new r.Texture(c),jump:new r.Sound(l),hit:new r.Sound(p),gotEm:new r.Sound(u),grass:new r.Texture(h)},d=new r.Loader,y=new r.SpriteSheet(f.bot,8,1,32,32),w=new r.SpriteSheet(f.botRed,8,1,32,32),g=new r.SpriteSheet(f.baddie,6,1,32,32),v=f.block.asSprite(),b=f.npc.asSprite(),m=new r.SpriteSheet(f.grass,8,8,32,32);for(var _ in f)d.addResource(f[_]);var O,C,x=(O=function(t,e){return(O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}O(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),S=function(t){function e(e,o){var n=t.call(this,{pos:new r.Vector(e,o),body:new r.Body({collider:new r.Collider({type:r.CollisionType.Active,shape:r.Shape.Box(32,50),offset:new r.Vector(0,3),group:r.CollisionGroupManager.groupByName("player")})})})||this;return n.isJumping=!1,n.isJumpFirstCross=!0,n.jumpY=0,n.hurt=!1,n.hurtTime=0,n.isLeft=!1,n}return x(e,t),e.prototype.onInitialize=function(t){var e=y.getAnimationByIndices(t,[0,1,0,1,0,1],150);e.scale=new r.Vector(2,2);var o=y.getAnimationByIndices(t,[0,1,0,1,0,1],150);o.scale=new r.Vector(2,2),o.flipHorizontal=!0;var n=y.getAnimationByIndices(t,[2,3],800);n.scale=new r.Vector(2,2);var i=y.getAnimationByIndices(t,[2,3],800);i.scale=new r.Vector(2,2),i.flipHorizontal=!0;var s=y.getAnimationByIndices(t,[3,4,5,6,7],100);s.scale=new r.Vector(2,2);var a=y.getAnimationByIndices(t,[3,4,5,6,7],100);a.scale=new r.Vector(2,2),a.flipHorizontal=!0,this.addDrawing("hurtleft",e),this.addDrawing("hurtright",o),this.addDrawing("idleLeft",n),this.addDrawing("idleRight",i),this.addDrawing("left",s),this.addDrawing("right",a),this.on("postcollision",this.onPostCollision)},e.prototype.onPostCollision=function(t){t.side,r.Side.Top,(t.side===r.Side.Left||t.side===r.Side.Right)&&t.other instanceof A&&(this.vel.x<0&&!this.hurt&&this.setDrawing("hurtleft"),this.vel.x>=0&&!this.hurt&&this.setDrawing("hurtright"),this.hurt=!0,this.hurtTime=1e3,f.hit.play(.1))},e.prototype.getMoveDir=function(t){var e=new r.Vector(0,0);return t.input.keyboard.isHeld(r.Input.Keys.Left)&&(e.x=-1),t.input.keyboard.isHeld(r.Input.Keys.Right)&&(e.x=1),t.input.keyboard.isHeld(r.Input.Keys.Up)&&(e.y=-1),t.input.keyboard.isHeld(r.Input.Keys.Down)&&(e.y=1),e.normalize(),e},e.prototype.onPreUpdate=function(t,e){this.hurtTime>=0&&this.hurt&&(this.hurtTime-=e,this.hurtTime<0&&(this.hurt=!1)),this.pos.y-this.jumpY>=1e-11&&this.isJumping&&(this.isJumping=!1,this.pos.y=this.jumpY,this.acc=r.Vector.Zero);var o=this.getMoveDir(t);o.scaleEqual(150),this.isJumping&&(o.scaleEqual(.5),o.y=this.vel.y),this.vel=o,t.input.keyboard.isHeld(r.Input.Keys.Space)&&!this.isJumping&&(this.vel.y=-300,this.acc=new r.Vector(0,980),this.isJumping=!0,this.jumpY=this.pos.y,this.isJumpFirstCross=!0,f.jump.play(1)),this.vel.x<0?this.isLeft=!0:this.vel.x>0&&(this.isLeft=!1),this.hurt||(this.isLeft?this.setDrawing("left"):this.setDrawing("right"),0===this.vel.x&&(this.isLeft?this.setDrawing("idleLeft"):this.setDrawing("idleRight")))},e}(r.Actor),B=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),A=function(t){function e(e,o,n){var i=t.call(this,{pos:new r.Vector(e,o),body:new r.Body({collider:new r.Collider({type:r.CollisionType.Active,shape:r.Shape.Box(32,50),offset:new r.Vector(0,-1),group:r.CollisionGroupManager.groupByName("enemy")})})})||this;return i.dir=n,i}return B(e,t),e.prototype.onInitialize=function(t){var e=g.getAnimationByIndices(t,[2,3,4,5],100);e.scale=new r.Vector(2,2);var o=g.getAnimationByIndices(t,[2,3,4,5],100);o.scale=new r.Vector(2,2),o.flipHorizontal=!0,this.addDrawing("left",e),this.addDrawing("right",o),this.actions.moveBy(400*this.dir,0,100).moveBy(-400*this.dir,0,100).repeatForever(),this.on("postcollision",this.onPostCollision)},e.prototype.onPostCollision=function(t){t.other instanceof S&&t.side===r.Side.Bottom&&(f.gotEm.play(.5),this.actions.clearActions(),this.body.collider.type=r.CollisionType.PreventCollision,this.vel=new r.Vector(0,-300),this.acc=r.Physics.acc,this.rx=2)},e.prototype.onPostUpdate=function(){this.vel.x<0?this.setDrawing("left"):this.vel.x>0&&this.setDrawing("right")},e}(r.Actor),D=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),V=(C=m.columns,function(t,e){return C*e+t}),T=function(t){function e(e,o,n,i){var s,a,c,l,p,u=t.call(this,{pos:new r.Vector(e,o),scale:new r.Vector(2,2),anchor:r.Vector.Zero,body:new r.Body({collider:new r.Collider({type:r.CollisionType.PreventCollision,shape:r.Shape.Box(m.spWidth*n,m.spHeight*i,r.Vector.Zero),group:r.CollisionGroupManager.groupByName("floor")})})})||this;u.cols=n,u.rows=i,u.indicies=[];for(var h=0;h<u.cols;h++)for(var f=0;f<u.rows;f++){var d=(s=0,a=7,c=0,l=7,p=void 0,p=Math.floor(Math.random()*(a-s))+s,(Math.floor(Math.random()*(l-c))+c)*(a-s)+p);u.indicies.push(d)}return u}return D(e,t),e.prototype.onPostDraw=function(t){for(var e=0;e<this.cols;e++)for(var o=0;o<this.rows;o++){var r=this.indicies[V(e,o)];m.getSprite(r).draw(t,e*m.spWidth,o*m.spHeight)}},e}(r.Actor),j=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),P=function(t){function e(e,o,n,i){var s=t.call(this,{pos:new r.Vector(e,o),scale:new r.Vector(2,2),anchor:r.Vector.Zero,body:new r.Body({collider:new r.Collider({type:r.CollisionType.Fixed,shape:r.Shape.Box(20*n,15*i,r.Vector.Zero),group:r.CollisionGroupManager.groupByName("floor")})})})||this;return s.cols=n,s.rows=i,s}return j(e,t),e.prototype.onPostDraw=function(t){for(var e=0;e<this.cols;e++)for(var o=0;o<this.rows;o++)v.draw(t,e*v.drawWidth,o*v.drawHeight)},e}(r.Actor),I=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),k=function(t){function e(e,o){var n=t.call(this,{pos:new r.Vector(e,o),body:new r.Body({collider:new r.Collider({type:r.CollisionType.Active,shape:r.Shape.Box(32,50),offset:new r.Vector(0,3),group:r.CollisionGroupManager.groupByName("player")})})})||this;return n.onGround=!0,n.hurt=!1,n.hurtTime=0,n}return I(e,t),e.prototype.onInitialize=function(t){this.z=-1;var e=w.getAnimationByIndices(t,[0,1,0,1,0,1],150);e.scale=new r.Vector(2,2);var o=w.getAnimationByIndices(t,[0,1,0,1,0,1],150);o.scale=new r.Vector(2,2),o.flipHorizontal=!0;var n=w.getAnimationByIndices(t,[2,3],800);n.scale=new r.Vector(2,2);var i=w.getAnimationByIndices(t,[3,4,5,6,7],100);i.scale=new r.Vector(2,2);var s=w.getAnimationByIndices(t,[3,4,5,6,7],100);s.scale=new r.Vector(2,2),s.flipHorizontal=!0,this.addDrawing("hurtleft",e),this.addDrawing("hurtright",o),this.addDrawing("idle",n),this.addDrawing("left",i),this.addDrawing("right",s),this.actions.moveBy(100,0,20).moveBy(-100,0,20).repeatForever()},e.prototype.onPostUpdate=function(t,e){this.vel.x<0&&this.setDrawing("left"),this.vel.x>0&&this.setDrawing("right"),0===this.vel.x&&this.setDrawing("idle")},e.prototype.onPostDraw=function(t){b.draw(t,-10,-100)},e}(r.Actor),M=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),H=function(t){function e(e){return t.call(this,e)||this}return M(e,t),e.prototype.onInitialize=function(t){t.backgroundColor=r.Color.Gray,r.CollisionGroupManager.create("player"),r.CollisionGroupManager.create("enemy"),r.CollisionGroupManager.create("floor");for(var e=new S(100,120),o=new A(200,270,1),n=new A(100,270,-1),i=new k(400,170),s=0;s<10;s++)for(var a=0;a<10;a++){var c=new T(320*(a-4),320*(s-4),10,10);t.add(c)}var l=new P(50,200,1,10);t.add(e),t.add(i),t.add(o),t.add(n),t.add(l),this.camera.clearAllStrategies(),this.camera.strategy.elasticToActor(e,.05,.05),this.camera.zoom(1.5)},e}(r.Scene),E=new r.Engine({backgroundColor:r.Color.fromHex("#000000"),displayMode:r.DisplayMode.FullScreen});E.setAntialiasing(!1),E.add("level",new H(E)),E.goToScene("level"),E.on("visible",(function(){console.log("start"),E.start()})),E.start(d).then((function(){console.log("game start")}))}},o={};function r(t){var n=o[t];if(void 0!==n)return n.exports;var i=o[t]={exports:{}};return e[t](i,i.exports,r),i.exports}r.m=e,t=[],r.O=(e,o,n,i)=>{if(!o){var s=1/0;for(p=0;p<t.length;p++){for(var[o,n,i]=t[p],a=!0,c=0;c<o.length;c++)(!1&i||s>=i)&&Object.keys(r.O).every((t=>r.O[t](o[c])))?o.splice(c--,1):(a=!1,i<s&&(s=i));if(a){t.splice(p--,1);var l=n();void 0!==l&&(e=l)}}return e}i=i||0;for(var p=t.length;p>0&&t[p-1][2]>i;p--)t[p]=t[p-1];t[p]=[o,n,i]},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t;r.g.importScripts&&(t=r.g.location+"");var e=r.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var o=e.getElementsByTagName("script");o.length&&(t=o[o.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=t})(),(()=>{var t={179:0};r.O.j=e=>0===t[e];var e=(e,o)=>{var n,i,[s,a,c]=o,l=0;for(n in a)r.o(a,n)&&(r.m[n]=a[n]);if(c)var p=c(r);for(e&&e(o);l<s.length;l++)i=s[l],r.o(t,i)&&t[i]&&t[i][0](),t[s[l]]=0;return r.O(p)},o=self.webpackChunkexcalibur_webpack=self.webpackChunkexcalibur_webpack||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))})();var n=r.O(void 0,[325],(()=>r(6)));n=r.O(n)})();
//# sourceMappingURL=main.js.map